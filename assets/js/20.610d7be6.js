(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{581:function(e,a,s){"use strict";s.r(a);var n=s(13),t=Object(n.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h3",{attrs:{id:"traefik-官网"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#traefik-官网"}},[e._v("#")]),e._v(" Traefik 官网")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("https://doc.traefik.io/traefik/user-guides/crd-acme/\n")])])]),s("p",[e._v("服务器初始化准备")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" traefik\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("touch")]),e._v(" traefik.res.yaml\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("touch")]),e._v(" traefik.svc.yaml\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("touch")]),e._v(" traefik.deploy.yaml\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n├─ /            \n└─ traefik\n   ├─ traefik.ingress.yaml\n   ├─ traefik.services.yaml\n   └─ traefik.deploy.yaml\n")])])]),s("h3",{attrs:{id:"traefik-ingress-yaml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#traefik-ingress-yaml"}},[e._v("#")]),e._v(" traefik.ingress.yaml")]),e._v(" "),s("p",[e._v("下载地址")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("https://raw.githubusercontent.com/traefik/traefik/v2.10/docs/content/reference/dynamic-configuration/kubernetes-crd-rbac.yml\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: traefik-ingress-controller\n\nrules:\n  - apiGroups:\n      - "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v("\n    resources:\n      - services\n      - endpoints\n      - secrets\n    verbs:\n      - get\n      - list\n      - "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("watch")]),e._v("\n  - apiGroups:\n      - extensions\n      - networking.k8s.io\n    resources:\n      - ingresses\n      - ingressclasses\n    verbs:\n      - get\n      - list\n      - "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("watch")]),e._v("\n  - apiGroups:\n      - extensions\n      - networking.k8s.io\n    resources:\n      - ingresses/status\n    verbs:\n      - update\n  - apiGroups:\n      - traefik.io\n      - traefik.containo.us\n    resources:\n      - middlewares\n      - middlewaretcps\n      - ingressroutes\n      - traefikservices\n      - ingressroutetcps\n      - ingressrouteudps\n      - tlsoptions\n      - tlsstores\n      - serverstransports\n    verbs:\n      - get\n      - list\n      - "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("watch")]),e._v("\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: traefik-ingress-controller\n\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: traefik-ingress-controller\nsubjects:\n  - kind: ServiceAccount\n    name: traefik-ingress-controller\n    namespace: default\n")])])]),s("h3",{attrs:{id:"traefik-services-yaml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#traefik-services-yaml"}},[e._v("#")]),e._v(" traefik.services.yaml")]),e._v(" "),s("p",[e._v("下载地址")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("https://raw.githubusercontent.com/traefik/traefik/v2.10/docs/content/user-guides/crd-acme/02-services.yml\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("apiVersion: v1\nkind: Service\nmetadata:\n  name: traefik\ntype: NodePort\nspec:\n  ports:\n    - protocol: TCP\n      name: web\n      port: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8000")]),e._v("\n    - protocol: TCP\n      name: admin\n      port: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8080")]),e._v("\n    - protocol: TCP\n      name: websecure\n      port: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4443")]),e._v("\n  selector:\n    app: traefik\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n\nspec:\n  ports:\n    - protocol: TCP\n      name: web\n      port: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("\n  selector:\n    app: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n")])])]),s("h3",{attrs:{id:"deployments-yaml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deployments-yaml"}},[e._v("#")]),e._v(" deployments.yaml")]),e._v(" "),s("p",[e._v("下载地址")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("https://raw.githubusercontent.com/traefik/traefik/v2.10/docs/content/user-guides/crd-acme/03-deployments.yml\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  namespace: default\n  name: traefik-ingress-controller\n\n---\nkind: Deployment\napiVersion: apps/v1\nmetadata:\n  namespace: default\n  name: traefik\n  labels:\n    app: traefik\n\nspec:\n  replicas: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n  selector:\n    matchLabels:\n      app: traefik\n  template:\n    metadata:\n      labels:\n        app: traefik\n    spec:\n      serviceAccountName: traefik-ingress-controller\n      containers:\n        - name: traefik\n          image: traefik:v2.10\n          args:\n            - --api.insecure\n            - --accesslog\n            - --entrypoints.web.Address"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(":8000\n            - --entrypoints.websecure.Address"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(":4443\n            - --providers.kubernetescrd\n            - --certificatesresolvers.myresolver.acme.tlschallenge\n            - --certificatesresolvers.myresolver.acme.email"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("foo@you.com\n            - --certificatesresolvers.myresolver.acme.storage"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("acme.json\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Please note that this is the staging Let's Encrypt server.")]),e._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Once you get things working, you should remove that whole line altogether.")]),e._v("\n            - --certificatesresolvers.myresolver.acme.caserver"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("https://acme-staging-v02.api.letsencrypt.org/directory\n          ports:\n            - name: web\n              containerPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8000")]),e._v("\n            - name: websecure\n              containerPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4443")]),e._v("\n            - name: admin\n              containerPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8080")]),e._v("\n\n---\nkind: Deployment\napiVersion: apps/v1\nmetadata:\n  namespace: default\n  name: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n  labels:\n    app: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n\nspec:\n  replicas: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("\n  selector:\n    matchLabels:\n      app: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n  template:\n    metadata:\n      labels:\n        app: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n    spec:\n      containers:\n        - name: "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),e._v("\n          image: traefik/whoami\n          ports:\n            - name: web\n              containerPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("\n")])])]),s("p",[e._v("执行文件")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("kubectl apply -f traefik.ingress.yaml\nkubectl apply -f traefik.services.yaml\nkubectl apply -f traefik.deployments.yaml\n")])])])])}),[],!1,null,null,null);a.default=t.exports}}]);